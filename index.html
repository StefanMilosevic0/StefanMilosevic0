<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="utf-8">
    <link rel="icon" href="logo.png">
    <title>Stefan Milosevic</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        function HelpCommand(name, desc) {
            this.name = name
            this.desc = desc
        }
        var helpComands = [
            new HelpCommand('SEE PROJECTS', 'Type "SEE PROJECTS" to see all my projects.'),
            new HelpCommand('VISIT GIT', 'Type "VISIT GIT" to visit my Git-Hub page.'),
            new HelpCommand('COLOR', ' Sets the default console foreground and background colors.'),
        ]
    </script>
</head>

<body>
    <style>
        body {
            background-color: black;
            color: white;
        }

        ::-moz-selection {
            /* Code for Firefox */
            color: black;
            background: rgba(255, 255, 255, 0.996);
        }

        ::selection {
            color: black;
            background: rgba(255, 255, 255, 0.998);
        }
    </style>
    <script>
        $(document).ready(function () {

            function write() {
                let showUrl = location.href.replace(/\//g, '\\')
                showUrl = showUrl.split('')

                if (showUrl[showUrl.length - 1] == '\\') {
                    showUrl[showUrl.length - 1] = '>'
                }
                else {
                    showUrl[showUrl.length] = '>'
                }
                showUrl = showUrl.join('')

                $('.underscore').remove()

                print(showUrl, null, true, 'write')
                print('', null, false, 'user-text')
                print('<code>_</code>', null, false, 'underscore')

                blinkUnderscore()
            }



            function NotRecognized(string) {
                return "'" + string + "'" + " is not recognized as an internal or external command,<br>operable program or batch file."
            }

            function print(string, elementSelector, br, classes = '') {
                let div = document.body;

                if (typeof elementSelector === 'string') {
                    div = $(elementSelector)
                }
                if (br) {
                    br = '<br>'
                }
                else {
                    br = ''
                }
                str =
                    $(div).append("<code class=" + classes + ">" + br + string + "</code>")

            }
            print("Hi, I'm Stefan", null, false)
            print('Type "help" to see options', null, true)
            write()

            var ctrlDown = false
            function keyDown(e) {
                $(document.body).keydown(function (e) {
                    let userTexts = $('.user-text');
                    let lastUserText = $(userTexts[userTexts.length - 1]);


                    switch (e.key) {
                        case 'Enter': {
                            executeComand(lastUserText.html().toLocaleLowerCase())
                            break;
                        }
                        case 'Backspace': {
                            let str = lastUserText.html()
                            str = str.substring(0, str.length - 1)
                            lastUserText.html(str)
                            break;
                        }
                        case 'Control': {
                            /*
                            ovo napravi da moze ctrl+c i ctrl+v
                            */
                            ctrlDown = true
                            break;
                        }
                        case 'c' || 'C': {
                            
                            if (ctrlDown) {
                                console.log('ctrl+c')
                                ctrlDown = false
                                let copyText = lastUserText.select()
                                document.execCommand('copy')
                                console.log(copyText)

                            }
                            break;
                        }
                        case 'v' || 'V': {
                            if (ctrlDown) {

                            }
                            break;
                        }
                        default: {
                            if (e.key.length > 1) {
                                return
                            }
                            else {
                                lastUserText.html(lastUserText.html() + e.key)
                            }
                        }
                    }




                })

            }

            function executeComand(string) {
                console.log('command executed')
                let stringLower = string.toLowerCase()

                if (stringLower == 'help') {

                    //print("For more information on a specific command, type HELP command-name", null, true)
                    for (let command of helpComands) {
                        print(command.name + '--->' + command.desc, null, true)
                    }
                    write()

                }
                else if (/^color/.test(stringLower)) {
                    console.log('das')
                }
                else if (stringLower == 'exit') {
                    console.log('dsa')
                    var customWindow = window.open('', '_blank', '');
                    //customWindow.close();
                }
                else {
                    print(NotRecognized(string), null, true)
                    write()
                }
            }

            function blinkUnderscore() {

                let writes = $('.write');
                if (writes.length > 0) {
                    console.log(writes.length)
                    let lastWrite = $(writes[writes.length - 1]);
                    setInterval(() => {
                        /*let lastChar = lastWrite.html().split('')[lastWrite.html().length - 1]

                        if(lastChar == '&gt;'){
                            return
                        }
                        
                        if (lastChar != '_') {
                            lastWrite.html(lastWrite.html() + '_')
                        }
                        else {
                            let str = lastWrite.html();
                            str = str.replace('_', '')
                            lastWrite.html(str)
                        }
                        */
                        if ($('.underscore').last().css('display') === 'none') {
                            $('.underscore').last().css('display', 'inline')
                        }
                        else {
                            $('.underscore').css('display', 'none')
                        }

                    }, 500)
                }
            }

            keyDown()
        })


    </script>


</body>

</html>